<html>
<head>
  <title>计算机组成原理</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/601967 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1255"/>
<h1>计算机组成原理</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2020/5/10 19:47</i></td></tr>
<tr><td><b>作者：</b></td><td><i>chocho</i></td></tr>
</table>
</div>
<br/>

<div>
<span><div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; font-weight: bold;">计算机组成原理</span></font></div><div><span style="font-size: 14pt;"><span style="font-size: 14pt; font-weight: bold;"><img src="计算机组成原理_files/1-5.jpg" type="image/jpeg" data-filename="1-5.jpg"/><img src="计算机组成原理_files/5.jpg" type="image/jpeg" data-filename="5.jpg"/><img src="计算机组成原理_files/5-10.jpg" type="image/jpeg" data-filename="5-10.jpg"/><img src="计算机组成原理_files/10-11.jpg" type="image/jpeg" data-filename="10-11.jpg"/><img src="计算机组成原理_files/11.jpg" type="image/jpeg" data-filename="11.jpg"/><img src="计算机组成原理_files/11（2）.jpg" type="image/jpeg" data-filename="11（2）.jpg"/><img src="计算机组成原理_files/11-14.jpg" type="image/jpeg" data-filename="11-14.jpg"/><img src="计算机组成原理_files/14.jpg" type="image/jpeg" data-filename="14.jpg"/><img src="计算机组成原理_files/15-19.jpg" type="image/jpeg" data-filename="15-19.jpg"/><img src="计算机组成原理_files/14-15.jpg" type="image/jpeg" data-filename="14-15.jpg"/><img src="计算机组成原理_files/19.jpg" type="image/jpeg" data-filename="19.jpg"/><img src="计算机组成原理_files/19（2）.jpg" type="image/jpeg" data-filename="19（2）.jpg"/><img src="计算机组成原理_files/19-20.jpg" type="image/jpeg" data-filename="19-20.jpg"/><img src="计算机组成原理_files/20-27.jpg" type="image/jpeg" data-filename="20-27.jpg"/><img src="计算机组成原理_files/27-29.jpg" type="image/jpeg" data-filename="27-29.jpg"/><img src="计算机组成原理_files/29-35.jpg" type="image/jpeg" data-filename="29-35.jpg"/><img src="计算机组成原理_files/35.jpg" type="image/jpeg" data-filename="35.jpg"/><img src="计算机组成原理_files/35-37.jpg" type="image/jpeg" data-filename="35-37.jpg"/><img src="计算机组成原理_files/37.jpg" type="image/jpeg" data-filename="37.jpg"/><img src="计算机组成原理_files/37-44.jpg" type="image/jpeg" data-filename="37-44.jpg"/><img src="计算机组成原理_files/44.jpg" type="image/jpeg" data-filename="44.jpg"/><img src="计算机组成原理_files/44（2）.jpg" type="image/jpeg" data-filename="44（2）.jpg"/><img src="计算机组成原理_files/44-45.jpg" type="image/jpeg" data-filename="44-45.jpg"/><img src="计算机组成原理_files/45.jpg" type="image/jpeg" data-filename="45.jpg"/><img src="计算机组成原理_files/45-50.jpg" type="image/jpeg" data-filename="45-50.jpg"/><img src="计算机组成原理_files/50-51.jpg" type="image/jpeg" data-filename="50-51.jpg"/><img src="计算机组成原理_files/51-55.jpg" type="image/jpeg" data-filename="51-55.jpg"/><img src="计算机组成原理_files/55-56.jpg" type="image/jpeg" data-filename="55-56.jpg"/><img src="计算机组成原理_files/56-59.jpg" type="image/jpeg" data-filename="56-59.jpg"/></span></span></div><div><span style="font-size: 14pt;"><span style="font-size: 14pt; font-weight: bold;"><img src="计算机组成原理_files/59-60.jpg" type="image/jpeg" data-filename="59-60.jpg"/></span></span></div><div><span style="font-weight: bold; font-size: 11pt;">指令周期基本概念</span></div><div><span style="font-size: 14.6667px;">指令周期、机器周期、时钟周期的关系与各自的概念。</span></div><div><span style="font-size: 14.6667px;">以下图，按照机器周期进行同步。</span></div><div><span style="font-size: 14pt;"><span style="font-size: 14pt; font-weight: bold;"><img src="计算机组成原理_files/QQ图片20200810205048.png" type="image/png" data-filename="QQ图片20200810205048.png"/></span></span></div><div><span style="font-weight: bold; font-size: 11pt;">早期时序系统：指令按照节拍执行。</span></div><div><span style="font-size: 14.6667px;">生成信号控制的逻辑表达式。</span></div><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200810212834.png" type="image/png" data-filename="QQ图片20200810212834.png" width="1105"/></span></div><div><span style="font-size: 14.6667px;"><span style="font-size: 14.6667px; font-weight: bold;">控制器</span></span></div><div><span style="font-size: 14.6667px;">时序产生器；</span></div><div><span style="font-size: 14.6667px;">（1）同步控制的</span><span style="font-size: 14.6667px; color: rgb(255, 0, 0);">机器周期数固定</span><span style="font-size: 14.6667px;">。</span></div><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200810213806.png" type="image/png" data-filename="QQ图片20200810213806.png"/></span></div><div><span style="font-size: 11pt;">（2）异步控制机器</span><span style="font-size: 11pt; color: rgb(255, 0, 0);">周期数不一样</span><span style="font-size: 11pt;">。</span></div><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200810214617.png" type="image/png" data-filename="QQ图片20200810214617.png" width="1139"/></span></div><div><span style="font-size: 14.6667px;"><span style="font-size: 14.6667px; font-weight: bold; color: rgb(255, 0, 0);">MIPS5个常见指令周期</span></span></div><ul><li><div><span style="font-size: 14.6667px;"><span style="font-size: 14.6667px;">lw rt, imm(rs)       将内存中地址为imm+rs的数，加载出来，放入rt寄存器中。</span></span><br/></div></li></ul><div><span style="font-size: 14.6667px;">取指令过程忽略。</span></div><div><span style="font-size: 14.6667px;">公式：<b><font style="color: rgb(255, 0, 0);">Mem[R[rs]+imm]-&gt;R[rt]</font></b></span></div><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811113012.png" type="image/png" data-filename="QQ图片20200811113012.png" width="324"/></span></div><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811104004.png" type="image/png" data-filename="QQ图片20200811104004.png"/></span></div><div><span style="font-size: 11pt;"><br/></span></div><div><b><font style="font-size: 16pt;">--------------------------------------------------------62--------------------------------------------------</font></b></div><ul><li><div><font style="font-size: 11pt;">sw </font><span style="font-size: 14.6667px;">rt, imm(rs)      将tr寄存器中的数，存储到，内存中的地址imm+rs。</span></div></li></ul><div><span style="font-size: 14.6667px;">取指令过程忽略。</span></div><div><span style="font-size: 14.6667px;">公式：<b><font style="color: rgb(255, 0, 0);">R[rt]-&gt;Mem[R[rs]+imm]</font></b></span></div><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811130443.png" type="image/png" data-filename="QQ图片20200811130443.png" width="310"/></span></div><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811122432.png" type="image/png" data-filename="QQ图片20200811122432.png"/></span></div><div><span style="font-size: 11pt;"><br/></span></div><ul><li><div><span style="font-size: 11pt;">beq rs, rt, imm     当rs=rt时，将PC的值通过imm改变（即跳转）。</span></div></li></ul><div><span style="font-size: 14.6667px;">取指令过程忽略。</span></div><div><span style="font-size: 14.6667px;">公式：</span></div><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/}1734@QP6P3FUBBK_I69Q26.png" type="image/png" data-filename="}1734@QP6P3FUBBK_I69Q26.png" width="160"/></span></div><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811130515.png" type="image/png" data-filename="QQ图片20200811130515.png" width="336"/></span></div><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811130801.png" type="image/png" data-filename="QQ图片20200811130801.png"/></span></div><div><span style="font-size: 14.6667px;"><font style="color: rgb(255, 0, 0);">若PSW的状态不相等，则不执行T9</font>。</span></div><div><span style="font-size: 14.6667px;"><br/></span></div><ul><li><div><span style="font-size: 11pt;">add rd, rs, st        将rs+rt，存入寄存器rd中。</span></div></li></ul><div><span style="font-size: 14.6667px;">取指令过程忽略。</span></div><div><span style="font-size: 14.6667px;">公式：<b><font style="color: rgb(255, 0, 0);">R[rs]+R[rt]-&gt;R[rd]</font></b></span></div><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811131354.png" type="image/png" data-filename="QQ图片20200811131354.png" width="372"/></span></div><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811131357.png" type="image/png" data-filename="QQ图片20200811131357.png"/></span></div><div><span style="font-size: 14.6667px;"><br/></span></div><ul><li><div><span style="font-size: 11pt;">addi rt, rs, imm    将rs和立即数imm相加，存入寄存器rd中。</span></div></li></ul><div><span style="font-size: 14.6667px;">取指令过程忽略。</span></div><div><span style="font-size: 14.6667px;">公式：<b><font style="color: rgb(255, 0, 0);">R[rs]+imm-&gt;R[rt]</font></b></span></div><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811131124.png" type="image/png" data-filename="QQ图片20200811131124.png" width="319"/></span></div><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811131127.png" type="image/png" data-filename="QQ图片20200811131127.png"/></span></div><div><span style="font-size: 14.6667px;"><br/></span></div><div><span style="font-size: 14.6667px;">以下是MIPS结构：</span></div><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200810215509.png" type="image/png" data-filename="QQ图片20200810215509.png"/></span></div><div>从内存中<font style="color: rgb(255, 0, 0);">取指令</font>的数据通路建立过程：每条指令都会经过这个过程。</div><div><img src="计算机组成原理_files/QQ图片20200811104004 [1].png" type="image/png" data-filename="QQ图片20200811104004.png"/></div><div><b><font style="font-size: 11pt;">指令周期方框图（数据流）</font></b></div><div><img src="计算机组成原理_files/QQ图片20200811131655.png" type="image/png" data-filename="QQ图片20200811131655.png"/></div><div><br/></div><div><b><font style="font-size: 12pt;">硬布线控制器设计</font></b></div><div><font style="font-size: 11pt;">*控制器：控制指令自动执行。</font></div><div><span style="font-size: 14.6667px;"><b>三级时序硬布线控制器设计</b>：</span></div><div><span style="font-size: 14.6667px;"><font style="color: rgb(255, 0, 0);"><b>设计顺序：（2）（1）（3）（4）（5）（6）</b></font></span></div><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811151624.png" type="image/png" data-filename="QQ图片20200811151624.png" width="401"/></span></div><div><span style="font-size: 11pt;"><br/></span></div><ol><li><div><span style="font-size: 14.6667px;">设计出指令流程。</span></div></li></ol><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811141245.png" type="image/png" data-filename="QQ图片20200811141245.png"/></span></div><ol start="2"><li><div><span style="font-size: 14.6667px;">指令周期设计</span></div></li></ol><ul><li><div><span style="font-size: 14.6667px;">定长指令周期：3*4T</span></div></li></ul><div><span style="font-size: 14.6667px;">机器周期=3，表示3个阶段（取指令周期、计算周期、执行周期）。</span><br/></div><div><span style="font-size: 14.6667px;">节拍数=4，即取指令周期需要的节拍数。</span></div><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811144700.png" type="image/png" data-filename="QQ图片20200811144700.png" width="772"/></span></div><div><span style="font-size: 14.6667px;">输入：节拍脉冲，<font style="color: rgb(255, 0, 0);">驱动其他脉冲</font>的实现。</span></div><div><span style="font-size: 14.6667px;"><font style="color: rgb(255, 0, 0);"><b>输出：Mif、 Mcal、 Mex、T1、T2、T3</b></font></span></div><ul><li><div><span style="font-size: 14.6667px;">变长指令周期</span></div></li></ul><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811150117.png" type="image/png" data-filename="QQ图片20200811150117.png" width="744"/></span></div><ol start="3"><li><div><span style="font-size: 14.6667px;">时序发生器设计</span></div></li></ol><ul><li><div><span style="font-size: 14.6667px;">定长指令周期</span></div></li></ul><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811145832.png" type="image/png" data-filename="QQ图片20200811145832.png" width="1174"/></span></div><ul><li><div><font style="font-size: 11pt;">变长指令周期</font></div></li></ul><div><font style="font-size: 11pt;">需要结合指令类型，来确定需要哪些状态。</font></div><div><img src="计算机组成原理_files/QQ图片20200811150302.png" type="image/png" data-filename="QQ图片20200811150302.png" width="438"/></div><ol start="4"><li><div><span style="font-size: 14.6667px;">产生控制信号的设计</span></div></li></ol><div><font style="font-size: 11pt;">Lw等信号，由<font style="color: rgb(255, 0, 0);"><b>指令译码器</b></font>产生。</font></div><div><font style="font-size: 11pt;">M、T等信号，由<font style="color: rgb(255, 0, 0);"><b>时序电路</b></font>产生。</font></div><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811151208.png" type="image/png" data-filename="QQ图片20200811151208.png"/></span></div><div><span style="font-weight: bold; font-size: 16pt;">--------------------------------------------------------65--------------------------------------------------</span></div><div><font style="font-size: 11pt;"><b>现代时序布线控制器设计：</b></font></div><div><span style="font-size: 11pt;"><b><img src="计算机组成原理_files/QQ图片20200811164755.png" type="image/png" data-filename="QQ图片20200811164755.png" width="456"/></b></span></div><div><span style="font-size: 11pt;"><b><br/></b></span></div><div>将需要M和T组合来确定的控制信号，使用S状态码表示。</div><div><img src="计算机组成原理_files/QQ图片20200811164138.png" type="image/png" data-filename="QQ图片20200811164138.png" width="938"/></div><div><font style="font-size: 11pt;">根据分析获得<b><font style="color: rgb(255, 0, 0);">指令状态转换图-&gt;状态转换表</font></b>。</font></div><div><img src="计算机组成原理_files/QQ图片20200811164441.png" type="image/png" data-filename="QQ图片20200811164441.png" width="877"/></div><div><img src="计算机组成原理_files/N%]$C{1R[BJD47TJP[](G%2.png" type="image/png" data-filename="N%]$C{1R[BJD47TJP[](G%2.png" width="158"/></div><div><br/></div><div><b><font style="font-size: 14pt;">微程序控制器设计</font></b></div><div><img src="计算机组成原理_files/QQ图片20200811165348.png" type="image/png" data-filename="QQ图片20200811165348.png" width="297"/></div><div><font style="font-size: 11pt;">微指令</font></div><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811165930.png" type="image/png" data-filename="QQ图片20200811165930.png" width="674"/></span></div><div><span style="font-size: 14.6667px;">微程序：使用软件思想设计硬件</span></div><div><span style="font-size: 14.6667px;">程序、微程序、指令、微指令之间的关系：</span></div><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811170733.png" type="image/png" data-filename="QQ图片20200811170733.png" width="948"/></span></div><div><span style="font-size: 14.6667px;">微程序如何执行？存放？</span></div><div><span style="font-size: 14.6667px;"><b>取指令微程序：</b></span></div><div><span style="font-size: 11pt;"><b><img src="计算机组成原理_files/QQ图片20200811171507.png" type="image/png" data-filename="QQ图片20200811171507.png" width="858"/></b></span></div><div><span style="font-size: 11pt;"><b>lw指令微程序：</b></span></div><div><span style="font-size: 14.6667px;">省略取指令部分，注意取指令微程序的最后一个指令在00011的位置，因此lw的第一个指令应该在00100。</span></div><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811171920.png" type="image/png" data-filename="QQ图片20200811171920.png" width="857"/></span></div><div><span style="font-size: 11pt;">sw指令微程序省略。</span></div><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811172236.png" type="image/png" data-filename="QQ图片20200811172236.png" width="834"/></span></div><div><span style="font-size: 11pt;">add指令微程序省略。</span></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 14.6667px;"><b>微指令编码方法</b></span></div><ul><li><div><span style="font-size: 14.6667px;">直接表示法，29位</span><br/></div></li></ul><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811173158.png" type="image/png" data-filename="QQ图片20200811173158.png" width="635"/></span></div><div><span style="font-size: 14.6667px;">解决方案：去掉互斥位、去掉下址字段。</span></div><ul><li><div><span style="font-size: 14.6667px;">编码表示法，24位</span></div></li></ul><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811173419.png" type="image/png" data-filename="QQ图片20200811173419.png" width="699"/></span></div><ul><li><div><span style="font-size: 14.6667px;">混合表示法</span><br/></div></li></ul><div><br/></div><div><span style="font-weight: bold; font-size: 16pt;">--------------------------------------------------------66--------------------------------------------------</span></div><div><b><font style="font-size: 11pt;">去掉下址字段，微指令地址形成方法</font></b></div><div><span style="font-size: 14.6667px;">若判别字段为00，则uPC=uPC+1；</span></div><div><span style="font-size: 14.6667px;">若判别字段不为00，则需要使用地址转移逻辑。</span></div><ul><li><div><span style="font-size: 14.6667px;">下址字段法</span></div></li></ul><div><span style="font-size: 14.6667px;">在判别字段中增加了一位<font style="color: rgb(255, 0, 0);">是否到指令结尾</font>的判别位。</span></div><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811184456.png" type="image/png" data-filename="QQ图片20200811184456.png" width="820"/></span></div><div><span style="font-size: 11pt;"><br/></span></div><div><font style="font-size: 14pt;"><b>输入输出原理</b></font></div><div><span style="font-size: 11pt;">IO系统组成：外部设备（键盘、鼠标等）+接口部件+总线+对应的管理软件（驱动软件）</span></div><div><span style="font-size: 14.6667px;">IO系统作用：</span></div><ol><li><div><span style="font-size: 14.6667px;">完成计算机内部二进制与外部多种信息形式的交流。</span></div></li><li><div><span style="font-size: 14.6667px;">保证CPU可以选择正确的IO部件和方式。</span></div></li><li><div><span style="font-size: 14.6667px;">实现主机外设的速度匹配。</span></div></li></ol><div><span style="font-size: 14.6667px;"><b>输入输出过程</b></span></div><ul><li><div><span style="font-size: 14.6667px;">输入&lt;==</span><br/></div></li></ul><ol><li><div><span style="font-size: 14.6667px;">CPU将设备地址放到总线，选择设备。</span></div></li><li><div><span style="font-size: 14.6667px;">CPU等待输入设备有效。</span></div></li><li><div><span style="font-size: 14.6667px;">CPU从数据总线读入数据。</span></div></li></ol><ul><li><div><span style="font-size: 14.6667px;">输出==&gt;</span></div></li></ul><ol><li><div><span style="font-size: 14.6667px;">CPU将设备地址放到总线，选择设备。</span></div></li><li><div><span style="font-size: 14.6667px;">CPU把数据放到数据总线上。</span></div></li><li><div><font style="font-size: 11pt;">输出设备认为数据有效，取走数据。</font></div></li></ol><div><font style="font-size: 11pt;"><b>信息交换方式</b></font></div><div><span style="font-size: 11pt;"><b><img src="计算机组成原理_files/QQ图片20200811190427.png" type="image/png" data-filename="QQ图片20200811190427.png" width="316"/></b></span></div><ul><li><div><span style="font-size: 14.6667px;">反复查询设备状态，直到设备准备好。</span></div></li><li><div><span style="font-size: 14.6667px;">CPU串行执行，效率比较低。</span></div></li></ul><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811191004.png" type="image/png" data-filename="QQ图片20200811191004.png" width="525"/></span></div><ul><li><div><font style="font-size: 11pt;">中断的概念：CPU暂时中断现在程序执行，去执行某个随即服务，处理完后恢复现在程序执行。</font></div></li><li><div><span style="font-size: 14.6667px;">实质和特点：</span></div></li></ul><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811192349.png" type="image/png" data-filename="QQ图片20200811192349.png" width="439"/></span></div><ul><li><div><span style="font-size: 14.6667px;">分类</span></div></li></ul><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811192548.png" type="image/png" data-filename="QQ图片20200811192548.png" width="374"/></span></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 14.6667px;"><b>直接内存访问DMA方式</b></span></div><div><span style="font-size: 11pt;">*准备阶段和结束阶段需要占用CPU。</span></div><div><span style="font-size: 14.6667px;">*传输阶段DMAC从CPU接管总线，直接在内存和设备间进行传输。</span></div><div><span style="font-size: 14.6667px;"><br/></span></div><div><span style="font-size: 14.6667px;"><b>通道方式</b></span></div><div><span style="font-size: 14.6667px;">*代替CPU进行准备阶段（数据传送方向、内存地址、数据长度发给DMA）和结束阶段（向CPU发起中断请求，表示IO结束）。</span></div><div>*<font style="font-size: 11pt;">传输阶段DMAC从通道接管总线，直接在内存和设备间进行传输。</font></div><div><font style="font-size: 11pt;"><br/></font></div><div><span style="font-weight: bold; font-size: 16pt;">--------------------------------------------------------69--------------------------------------------------</span></div><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811201317.png" type="image/png" data-filename="QQ图片20200811201317.png" width="750"/></span><br/></div><div><span style="font-size: 14.6667px;"><b>中断响应流程</b></span></div><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811201818.png" type="image/png" data-filename="QQ图片20200811201818.png" width="399"/></span></div><div><span style="font-size: 14.6667px;"><b>中断的优先级</b></span></div><div><span style="font-size: 14.6667px;">*同时有中断请求，优先级高的先响应，优先级低的后响应。</span></div><div><span style="font-size: 14.6667px;">*CPU优先级会随中断服务器改变，与该中断设备优先级一样。</span></div><div><span style="font-size: 14.6667px;"><br/></span></div><div><span style="font-size: 14.6667px;"><b>单级中断和多级中断</b></span></div><ul><li><div><span style="font-size: 14.6667px;">单级中断：</span></div></li></ul><div><span style="font-size: 14.6667px;">优先级一样，离CPU近的会优先响应。</span><br/></div><div><span style="font-size: 14.6667px;">CPU处理某个中断时，不会被其他中断打断。</span></div><ul><li><div><span style="font-size: 14.6667px;">多级中断</span></div></li></ul><div><span style="font-size: 14.6667px;">优先级高的中断可以打断优先级低的。</span></div><div><span style="font-size: 14.6667px;">形成<font style="color: rgb(255, 0, 0);">中断嵌套</font>，将断点地址存入堆栈。</span></div><div><span style="font-size: 14.6667px;"><br/></span></div><div><span style="font-size: 14.6667px;"><b>优先级实现——中断仲裁</b></span></div><ul><li><div><span style="font-size: 14.6667px;">独立请求方式</span></div></li></ul><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811203032.png" type="image/png" data-filename="QQ图片20200811203032.png" width="587"/></span></div><div><span style="font-size: 14.6667px;">每个设备都和CPU有确定的引脚连接，因此设备直接发起请求即可获得许可。</span></div><ul><li><div><span style="font-size: 14.6667px;">链式查询方式——公共请求线</span></div></li></ul><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811203813.png" type="image/png" data-filename="QQ图片20200811203813.png" width="599"/></span></div><div><span style="font-size: 14.6667px;">只有一个总的请求和许可引脚，设备发起中断请求（请求中包含设备编码），CPU为对应的设备编码生成中断许可。中断许可从第一个设备开始传递，直到匹配到正确的设备。</span></div><ul><li><div><span style="font-size: 14.6667px;">分组链式——二维结构</span></div></li></ul><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811204019.png" type="image/png" data-filename="QQ图片20200811204019.png" width="597"/></span></div><div><span style="font-weight: bold; font-size: 16pt;">--------------------------------------------------------70--------------------------------------------------</span></div><div><font style="font-size: 11pt;"><b>中断屏蔽</b></font></div><ul><li><div><font style="font-size: 11pt;">响应优先级：硬件设计好后就固定了。</font></div></li><li><div><span style="font-size: 14.6667px;">处理优先级：使用屏蔽技术，可以改变处理优先级；若不使用屏蔽技术，则处理优先级=响应优先级。</span></div></li></ul><div><span style="font-size: 14.6667px;">中断屏蔽方式：</span></div><div><span style="font-size: 14.6667px;"><font style="color: rgb(255, 0, 0);">只能处理可屏蔽中</font><font style="color: rgb(255, 0, 0);"><font>断</font>，不可屏蔽中断直接连接到CPU</font>。</span></div><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811205713.png" type="image/png" data-filename="QQ图片20200811205713.png" width="554"/></span></div><div><span style="font-size: 11pt;"><br/></span></div><div><font style="font-size: 11pt;">屏蔽码：</font></div><div><font style="font-size: 11pt;">即图中的INM的编码。</font></div><div><font style="font-size: 11pt;"><b>中断识别：（寻找地址入口）</b></font></div><div><img src="计算机组成原理_files/QQ图片20200811211439.png" type="image/png" data-filename="QQ图片20200811211439.png" width="677"/></div><div><span style="font-weight: bold; font-size: 16pt;">--------------------------------------------------------71--------------------------------------------------</span></div><div><font style="font-size: 11pt;">中断响应条件：</font></div><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811212558.png" type="image/png" data-filename="QQ图片20200811212558.png" width="298"/></span><br/></div><div><span style="font-size: 11pt;"><br/></span></div><div><b><font style="font-size: 12pt;">DMA与通道</font></b></div><div><span style="font-size: 14.6667px;">*DMA</span></div><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811213718.png" type="image/png" data-filename="QQ图片20200811213718.png" width="531"/></span></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 11pt;"><b>DMA和外设的连接方式：</b></span></div><ul><li><div><span style="font-size: 14.6667px;">单通道MDA控制器</span></div></li></ul><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811214851.png" type="image/png" data-filename="QQ图片20200811214851.png" width="461"/></span></div><ul><li><div><span style="font-size: 14.6667px;">选择型MDA控制器</span></div></li></ul><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811225233.png" type="image/png" data-filename="QQ图片20200811225233.png" width="456"/></span></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 11pt;"><b>DMA控制器工作状态</b></span></div><ul><li><div><font style="font-size: 11pt;">被动状态——受控器：没有取得总线控制权，受CPU控制，相当于一个外设。</font></div></li><li><div><span style="font-size: 14.6667px;">主动状态——主控器：接管总线控制权，取代CPU成为主控者。</span></div></li><li><div><span style="font-size: 11pt;"><br/></span></div></li></ul><div><span style="font-size: 14.6667px;"><b>内存争用：CPU和DMA同时都需要访问内存</b></span></div><ul><li><div><span style="font-size: 14.6667px;">停止CPU使用主内存</span></div></li></ul><div><span style="font-size: 14.6667px;">CPU仅暂停取数据的步骤，其他步骤可以继续执行</span><br/></div><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811230121.png" type="image/png" data-filename="QQ图片20200811230121.png" width="442"/></span></div><ul><li><div><span style="font-size: 14.6667px;">DMA和CPU交替使用</span></div></li></ul><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811230227.png" type="image/png" data-filename="QQ图片20200811230227.png" width="386"/></span></div><div><span style="font-size: 11pt;"><br/></span></div><ul><li><div><span style="font-size: 14.6667px;"><b>周期挪用法</b>，又称周期窃取（比如在取值周期插入wait），优先DMA访问</span></div></li></ul><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811230348.png" type="image/png" data-filename="QQ图片20200811230348.png" width="394"/></span></div><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 14.6667px;"><b>一个数据块的传送过程</b></span></div><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811231018.png" type="image/png" data-filename="QQ图片20200811231018.png" width="536"/></span></div><div><br/></div><div><font style="font-size: 11pt;"><b>DMA主要操作过程</b></font></div><div><font style="font-size: 11pt;">准备阶段+传送阶段+结束阶段</font></div><div><font style="font-size: 11pt;">（1）准备阶段：CPU将以下参数传给DMA</font></div><ul><li><div><font style="font-size: 11pt;">数据传送方向</font></div></li><li><div><font style="font-size: 11pt;">数据块在主存的首地址</font></div></li><li><div><font style="font-size: 11pt;">数据在外设的地址</font></div></li><li><div><font style="font-size: 11pt;">数据的传送量</font></div></li></ul><div><span style="font-size: 11pt;">（2）传送阶段：DMA是<font style="color: rgb(255, 0, 0);">连续</font>传送一个<font style="color: rgb(255, 0, 0);">数据块</font></span></div><div><span style="font-size: 11pt; color: rgb(255, 0, 0);"><img src="计算机组成原理_files/QQ图片20200811231542.png" type="image/png" data-filename="QQ图片20200811231542.png" width="548"/></span></div><div><span style="font-size: 11pt;">（3）结束阶段：向主机发起<font style="color: rgb(255, 0, 0);">中断请求</font>，CPU执行中断服务</span></div><ul><li><div><font style="font-size: 11pt;">正常结束，数据块传输完毕</font></div></li><li><div><font style="font-size: 11pt;">非正常结束，DMA故障</font></div></li></ul><div><span style="font-size: 11pt;"><br/></span></div><div><span style="font-size: 14.6667px;"><b>DMA与中断的区别</b></span></div><div><span style="font-size: 11pt;"><img src="计算机组成原理_files/QQ图片20200811231818.png" type="image/png" data-filename="QQ图片20200811231818.png" width="598"/></span></div><div><br/></div></div></span>
</div></body></html> 